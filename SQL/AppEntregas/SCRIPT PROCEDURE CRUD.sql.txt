-- EXEMPLOS SP DE INSERT, DELETE, UPDATE E SELECT

--SP DE INSERT
CREATE PROCEDURE SP_INS_BANCO
(@CODBANCO INT OUTPUT,
 @NOME VARCHAR(100),
 @RUA VARCHAR(100),
 @NUMERO INT,
 @BAIRRO VARCHAR(100),
 @COMPLEMENTO VARCHAR(50),
 @CODCIDADE INT
)
AS
BEGIN
	INSERT INTO BANCOS(NOME,RUA,NUMERO,BAIRRO,COMPLEMENTO,CODCIDADE)
	VALUES (@NOME,@RUA,@NUMERO,@BAIRRO,@COMPLEMENTO,@CODCIDADE)

	SET @CODBANCO = @@IDENTITY
	PRINT @CODBANCO
	PRINT @@IDENTITY
END

DECLARE @CODBANCO INT
EXEC SP_INS_BANCO @CODBANCO,'TESTE','TESTE',12,'TESTE','TESTE',1

--SP DE DELETE
CREATE PROCEDURE SP_DEL_BANCO
(@STATUS INT OUTPUT,
 @CODBANCO INT
)
AS
BEGIN
	DELETE FROM BANCOS 
	WHERE CODBANCO = @CODBANCO
	IF (@@ERROR <> 0)
	  SET @STATUS = -1
	ELSE
	  SET @STATUS = 0
	  
	PRINT @STATUS  
END

DECLARE @RETORNO INT
EXEC SP_DEL_BANCO 3, @RETORNO

--SP DE UPDATE
CREATE PROCEDURE SP_UPD_BANCO
(@CODBANCO INT,
 @NOME VARCHAR(100),
 @RUA VARCHAR(100),
 @NUMERO INT,
 @BAIRRO VARCHAR(100),
 @COMPLEMENTO VARCHAR(50),
 @CODCIDADE INT,
 @STATUS INT
)
AS
BEGIN
	UPDATE BANCOS 
	SET NOME = @NOME,
	    RUA = @RUA,
		NUMERO = @NUMERO,
		BAIRRO = @BAIRRO,
		COMPLEMENTO = @COMPLEMENTO,
		CODCIDADE = @CODCIDADE
	WHERE CODBANCO = @CODBANCO

	IF (@@ERROR <> 0)
	  SET @STATUS = -1
	ELSE
	  SET @STATUS = 0
	  
	PRINT @STATUS

END

DECLARE @RETORNO INT
EXEC SP_UPD_BANCO 3,'TESTE1','TESTE1',12,'TESTE','TESTE',1, @RETORNO

--SP DE SELECT
CREATE PROCEDURE SP_SEL_BANCO
(@CODBANCO INT,
 @NOME VARCHAR(100),
 @RUA VARCHAR(100),
 @NUMERO INT,
 @BAIRRO VARCHAR(100),
 @COMPLEMENTO VARCHAR(50),
 @CODCIDADE INT
)
AS
BEGIN
	SELECT CODBANCO,
		   NOME,
		   RUA,
		   NUMERO,
		   BAIRRO,
		   COMPLEMENTO,
		   CODCIDADE
	FROM
	 BANCOS
	WHERE ((@CODBANCO IS NULL) OR (CODBANCO = @CODBANCO))
	AND ((@NOME IS NULL) OR (NOME = @NOME))
	AND ((@RUA IS NULL) OR (RUA = @RUA))
	AND ((@NUMERO IS NULL) OR (NUMERO = @NUMERO))
	AND ((@BAIRRO IS NULL) OR (BAIRRO = @BAIRRO))
	AND ((@CODCIDADE IS NULL) OR (CODCIDADE = @CODCIDADE))
END

EXEC SP_SEL_BANCO NULL, NULL, NULL, NULL,NULL,NULL,NULL
EXEC SP_SEL_BANCO 1, NULL, NULL, NULL,NULL,NULL,NULL
